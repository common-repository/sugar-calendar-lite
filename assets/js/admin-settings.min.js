!function(s,n,t){"use strict";var i=window.SugarCalendar||{};i.Admin=i.Admin||{},s.fn.dateTimeFormat=function(t,i){this.each(function(){this.settings=t,this.$options=this.find('[type="radio"]:not([data-custom-option])'),this.$customOption=this.find("[data-custom-option]"),this.$customField=this.find("[data-custom-field]"),this.$formatExample=this.find("[data-format-example]"),this.$spinner=this.find("[data-spinner]"),this.debounce=null,this.$options.on("click",function(t){var t=s(t.target),i=t.parent().find("[data-format-i18n]").text();this.$customField.val(t.val()),this.$formatExample.text(i)}.bind(this)),this.$customField.on("click input",function(){this.$customOption.prop("checked",!0)}.bind(this)),this.$customField.on("input",function(){clearTimeout(this.debounce),""!==this.$customField.val()&&(this.$spinner.addClass("is-active"),this.debounce=setTimeout(()=>{s.post(this.settings.ajax_url,{task:"date_time_format",date_time_format:this.$customField.val()}).done(t=>{t.success&&t.data&&this.$formatExample.text(t.data)}).always(()=>this.$spinner.removeClass("is-active"))},400))}.bind(this))}.bind(this))},i.Admin.Settings={init:function(t){s("#screen-meta-links, #screen-meta").prependTo("#sugar-calendar-header-temp").show(),this.initDateTimeFormats(),this.initChoicesJS(),this.initSandboxToggleListener()},initChoicesJS:function(){s(".choicesjs-select").each((t,i)=>{new n(i,{itemSelectText:""})})},initDateTimeFormats:function(){s("#sugar-calendar-setting-row-date_format").dateTimeFormat(t),s("#sugar-calendar-setting-row-time_format").dateTimeFormat(t)},initSandboxToggleListener:function(){s("#sugar-calendar-setting-sandbox").on("change",t=>{this.toggleSandboxConnectURL(s(t.target).is(":checked"))})},toggleSandboxConnectURL:function(t){var i=this,n=(s("#sugar-calendar-setting-sandbox").off("change"),s("#sugar-calendar-setting-row-stripe-connect .sugar-calendar-stripe-connect").first()),e=n.attr("href"),e=new URL(e),a=new URLSearchParams(e.search);a.set("live_mode",t?0:1),n.attr("href",e.origin+e.pathname+"?"+a.toString()),this.ajaxSaveOptions({sandbox:t?1:0},{success:function(){i.initSandboxToggleListener()},always:function(){i.initSandboxToggleListener()}})},ajaxSaveOptions:function(t,i){var n=new URL(sugar_calendar_admin_settings.ajax_url),e=new URLSearchParams(n.searchParams),n=n.origin+n.pathname,a=e.get("_wpnonce"),e=e.get("page_id");s.ajax({url:n,type:"POST",data:{action:"sugar_calendar_admin_area_handle_post",options:t,nonce:a,pageId:e},success:function(t){"function"==typeof i.success&&i.success(t)},error:function(t){"function"==typeof i.error&&i.error(t)},always:function(t){"function"==typeof i.always&&i.always(t)}})}},i.Admin.Settings.init(t),window.SugarCalendar=i}(jQuery,Choices,sugar_calendar_admin_settings,document);