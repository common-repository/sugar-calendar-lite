!function(t,i,n){"use strict";var e=window.SugarCalendar||{};e.Admin=e.Admin||{},e.Admin.Events={init:function(n){this.settings=n,this.$calendarDropdown=t("#sc_event_category"),this.$screenOptionsToggle=t("#sugar-calendar-screen-options-toggle"),this.$screenOptionsMenu=t(".sugar-calendar-screen-options-menu"),this.$columnFields=t('[name="sugar-calendar[columns][]"]',this.$screenOptionsMenu),this.$gridColumnLayout=t("#sugar-calendar-table-grid-column-layout"),this.bindEvents(),this.initializeTooltips()},bindEvents:function(){this.$calendarDropdown.on("change",n=>t(n.target).parents("form").submit()),this.$screenOptionsToggle.on("click",this.onScreenOptionsToggleClick.bind(this)),this.$columnFields.on("click",this.onColumnsChange.bind(this))},onScreenOptionsToggleClick:function(n){this.$screenOptionsToggle.toggleClass("open"),this.$screenOptionsMenu.fadeToggle(200)},onColumnsChange:function(n){var e=this.$columnFields.map(function(){var n=t(this);return{id:n.val(),visible:n.is(":checked")}}).toArray();this.hideColumns(e),this.hideEventSpans(e),this.updateGridColumnLayout(e),this.updateHiddenColumns(e)},hideColumns:function(n){n=n.filter(n=>!n.visible).map(n=>".column-"+n.id).join(",");t(".column, th, td",".sugar-calendar-table").removeClass("hidden"),t(n,".sugar-calendar-table").addClass("hidden")},hideEventSpans:function(n){const e=n.filter(n=>!n.visible).map(n=>n.id);t(".event-span",".sugar-calendar-table-events").removeClass("hidden"),t(".event-span",".sugar-calendar-table-events").each(function(){var n=t(this);0===n.attr("data-days").split(",").filter(n=>!e.includes(n)).length&&n.addClass("hidden")})},updateGridColumnLayout:function(t){var n=t.map(n=>{var e=n.id===t[0].id?"120px":"1fr",e=n.visible?`minmax(0, ${e})`:"0fr";return`[${n.id}] `+e}).join(" ");this.$gridColumnLayout.html(`
				.sugar-calendar-table-events {
					--grid-template-columns: ${n};
				}
			`)},updateHiddenColumns:function(n){n=n.filter(n=>!n.visible).map(n=>n.id);t.post(this.settings.ajax_url,{columns:n,mode:t("[name=mode]",this.$screenOptionsMenu).val(),cd:t("[name=cd]",this.$screenOptionsMenu).val(),cm:t("[name=cm]",this.$screenOptionsMenu).val(),cy:t("[name=cy]",this.$screenOptionsMenu).val(),task:"update_hidden_columns"})},initializeTooltips:function(){var n=t(".sugar-calendar-event-entry"),e=t(".sugar-calendar-event-entry span");n.on("click",n=>n.preventDefault()),e.each(function(){i(t(this).get(0),{trigger:"click",allowHTML:!0,interactive:!0,triggerTarget:t(this).parent("a").get(0),offset:[0,12],content(n){n=n.parentElement.getAttribute("data-id");return t("#sugar-calendar-tooltip-"+n).html()}})})}},e.Admin.Events.init(n),window.SugarCalendar=e}(jQuery,tippy,sugar_calendar_admin_events);